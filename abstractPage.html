<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Abstract Page</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="http://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
	<link rel="stylesheet" href ="css/abstractPage.css">
	<script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container-fluid col-xs-10 col-xs-offset-1">
		<div class="header" id="headerDiv">
			<h1 id="title">Abstract for *Title*</h1>

		</div>

		<div class="content">
			<h4 id="abstractContent"></h4>

			<button class="btn" id="buttondownload" onclick="downloadBtnClicked">Download as PDF </button>
		</div>
	</div>
	<script type="text/javascript">

		$(document).ready(function(){

			var pageTitle = "Blank";

		  	var request = $.ajax({
				url: "GetCurrentTitle.php",
				type: "GET",
				dataType: "text"
			});
			request.done(function(msg) {

				var request = $.ajax({
					url: "GetCurrentWord.php",
					type: "GET",
					dataType: "text"
				});
				request.done(function(msg2) {
						console.log("Title: " + msg);
						pageTitle = msg;
						wordd = msg2;
						document.getElementById("title").innerHTML = pageTitle;
						getAbstract(pageTitle, wordd);
				});


			});

			function getAbstract(title, wordd){
				console.log("This is " + wordd);
				$.ajax({
			      url: "http://ieeexplore.ieee.org/gateway/ipsSearch.jsp?ti="+ title,
			      dataType: "xml",
			      success: function( response ) {
			        var abstract = response.getElementsByTagName("document")[0].getElementsByTagName("abstract")[0]["textContent"];
			        console.log("abstract is: " + abstract);
							abstract = abstract.toLowerCase();
			        var newAbstract = abstract.split(wordd).join('<span class="highlight">' + wordd + '</span>');

			        document.getElementById('abstractContent').innerHTML = newAbstract;

			      },
			      error: function(xhr, error){
			      	// alert(error + xhr);
			      }
		    	});
			}



	  	});
	</script>
</body>
